<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="shortcut icon" type="image/png" href="img/topi-chef.png" />
    <title>Let's Start</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
        integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.13.0/css/all.min.css">
</head>

<body class="container px-lg-4 px-md-4 px-0" style="background: ghostwhite;">
    <!-- ini Header -->
    <header class="mt-3">
        <img-brand></img-brand>
        <top-navigasi></top-navigasi>
    </header>
    <!-- ini batas header -->

    <!-- ini main -->
    <main>
        <!-- ini Search Untuk Mencari Nama Makanan -->
        <search-food></search-food>
       
        <!-- ini Menu Makanan -->
        <article class="row p-lg-3 p-md-3 pl-lg-5 pl-md-5 pr-lg-5 pr-md-5 px-0" id="food"></article>
    </main>
    <!-- ini batas Main -->
    
    <footer>
        <section>
            <bottom-navigasi></bottom-navigasi>
        </section>

        <section class=" d-none d-lg-flex  bg-info text-white">
            <div class="p-2 pl-3 ">Follow US</div>
            <div class="p-2 pl-3 ">
                <i class="fab fa-facebook-f "></i>
            </div>
            <div class="p-2 pl-3 ">
                <i class="fab fa-instagram "></i>
            </div>
            <div class="p-2 pl-3 ">
                <i class="fab fa-twitter "></i>
            </div>
            <div class="p-2 pl-3 ">
                <i class="fab fa-youtube "></i>
            </div>
        </section>

        <section class="d-flex flex-lg-row  flex-column bd-highlight  bg-info text-white text-center">
            <!-- <div class="p-2 flex-grow-1 bd-highlight"> &copy; <span id="year"></span> - KambingKacangKU</div> -->
            <div class="p-2 flex-lg-grow-1 bd-highlight"> &copy; <span>2020</span> - let's cook </div>
            <div class="p-2 pl-3  bd-highlight">Tentang Kami</div>
            <div class="p-2 pr-3 bd-highlight">FAQ</div>
        </section>
    </footer>

    
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"
        integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous">
    </script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"
        integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous">
    </script>
    <script src="js/customElement/ImgBrand.js"></script>
    <script src="js/customElement/TopNavigasi.js"></script>
    <script src="js/customElement/BottomNavigasi.js"></script>
    <script src="js/customElement/SlideShow.js"></script>
    <script src="js/customElement/FoodsMenu.js"></script>
    <script src="js/customElement/SearchFood.js"></script>
    <script>
        // 9799e4a8262c49c1b03f3dc9355932b0
        // b767ad49f6e345529694c796f1488384
        // 636bbc3497d5423e828a27c525089040
        // 5538dce56bda43fa8b107fe4fdf313d
        // 8970425faa034116a7ded95951609cdb

        const apiKey = "apiKey=8970425faa034116a7ded95951609cdb";
        $(document).ready(function () {
            const minProtein = Math.floor(Math.random() * (50 - 10 + 1)) + 10;
            const maxProtein = Math.floor(Math.random() * (100 - 50 + 1)) + 50;

            $.get("https://api.spoonacular.com/recipes/findByNutrients?minCarbs=" + minProtein +
                "&maxCarbs=" + maxProtein + "&number=8&" + apiKey,
                function (data) {

                    $('#food').append("<foods-menu></foods-menu>");
                    $.each(data, function (i) {
                        $('#foodsMenu').append(`
                            <div class="col-lg-3 col-md-4 col-12 p-lg-2 pt-lg-0 p-md-2 pt-md-0 py-sm-2 pt-sm-0 text-center">
                                <a class="food-recipe " href="${data[i].id}" id="${data[i].image}"
                                    name="${data[i].title}">
                                    <div class="card " style="">
                                        <img src="${data[i].image}" class="card-img-top" alt="...">
                                        <div class="card-body">
                                            <p class="card-title">${data[i].title}
                                            </p>
                                        </div>
                                    </div>
                                </a>
                            </div>
                        `);
                    });

                    recipe()
                });

            foodOrigin()
            
            pencarianMakanan();           
        });

function pencarianMakanan() {
    $('#searchFood').keyup(function () {
    const listSearch = `
    <ul class="list-group list-group-flush " style="     position: absolute;   z-index: 1;   " id="searchItem">
        <!-- item List -->
    </ul>
    `;
    const inputSearch = $(this).val();
    $('#search').html(' ');
    $.get("https://api.spoonacular.com/food/products/suggest?query=" + inputSearch +
    "&number=7&apiKey=5538dce56bda43fa8b107fe4fdf313da",
    function (dataSearch) {
    $('#search').append(listSearch);

    $.each(dataSearch.results, function (i) {
    $('#searchItem').append(`
    <li class="list-group-item py-2 px-4">${dataSearch.results[i].title}</li>`);
    });

    });
    });
  }

        function foodOrigin() {
            $('.foodOrigin').click(function (e) {
                e.preventDefault();
                 $('#food').html(" ");
                 $('#food').append("<foods-menu></foods-menu>");
                const origin = $(this).text();
                $.get("https://api.spoonacular.com/recipes/complexSearch?cuisine=" + origin + "&number=8&" +
                    apiKey,
                    function (data) {
                        $.each(data.results, function (i) {
                            console.log(data.results[i].image);
                            $('#foodsMenu').append(`
                                <div class="col-lg-3 col-md-4 col-12 p-lg-2 p-md-2 text-center">
                                    <a class="food-recipe " href="${data.results[i].id}" id="${data.results[i].image}" name="${data.results[i].title}">
                                        <div class="card " style="">
                                            <img src="${data.results[i].image}" class="card-img-top" alt="...">
                                            <div class="card-body">
                                                <p class="card-title">${data.results[i].title}
                                                </p>
                                            </div>
                                        </div>
                                    </a>
                                </div>
        `);
                        });
                    });
            });
        }


        function recipe() {
            $('.food-recipe').click(function (e) {
                e.preventDefault();
                const a = $(this).attr('href');
                const b = $(this).attr('id');
                const c = $(this).attr('name');
                // const c = $(this).text();
                $('food').html("");
                const templateRecipe = ` <div class="d-none d-lg-block col-lg-4 pl-0 pr-0 pr-lg-3 ">
            <div class="card" style="" id="nutrition">
            </div>
        </div>
        <div class="col-lg-8">
            <div class="row">

                <!-- This Is Ingredients -->
                <div class="col-lg-12 pt-lg-4 mt-lg-0 pt-0  mt-3 text-center bg-white rounded">
                    <img src="https://spoonacular.com/recipeImages/716429-556x370.jpg"
                        class="img-fluid rounded d-lg-none " alt="...">
                    <h5 class=" d-lg-none ">Pasta with Garlic, Scallions, Cauliflower & Breadcrumbs</h5>
                    <h3>Ingredients</h3>
                    <div class=" row  " id="listIngredients">

                    </div>
                </div>
                <!-- This Is Step -->
                <div class="col-lg-12  pt-lg-4 mt-lg-0 pt-0  mt-lg-2 text-center bg-white rounded">
                    <h3 class="text-center">Step</h3>
                    <div class="col-12 text-left">
                        <ul class="list-group list-group-flush text-justify" id="listRecipeStep">

                        </ul>
                    </div>
                </div>
            </div>
        </div>`;
                const test = "https://api.spoonacular.com/recipes/" + a + "/nutritionWidget.json?" + apiKey;
                console.log(test);
                $.get(test,
                    function (data) {
                        $('#nutrition').append(`
        <img src="${b}" class="card-img-top" alt="...">
        <div class="card-body">
            <h5 class="card-title text-center">${c}</h5>
            <ul class="list-group list-group-flush">
                <li class="list-group-item">Calories: ${data.calories}</li>
                <li class="list-group-item">Carbs: ${data.carbs}</li>
                <li class="list-group-item">Fat: ${data.fat}</li>
                <li class="list-group-item">Protein: ${data.protein}</li>
            </ul>
        </div>
        </div>
        `);
                    }
                );

                const test3 = "https://api.spoonacular.com/recipes/" + a + "/ingredientWidget.json?" + apiKey;
                $('#food').html(templateRecipe);
                $.get(test3,
                    function (dataI) {
                        $.each(dataI.ingredients, function (i) {
                            console.log(dataI.ingredients[i].amount.metric.value);
                            $('#listIngredients').append(`
        <div class="col-5 offset-1 text-left">
            <p>${nomor = i+1}) ${dataI.ingredients[i].name} ${dataI.ingredients[i].amount.metric.value}
                ${dataI.ingredients[i].amount.metric.unit}</p>
        </div>
        `);
                        });
                    }
                );

                const test2 = "https://api.spoonacular.com/recipes/" + a + "/analyzedInstructions?" + apiKey;
                $.get(test2,
                    function (datal) {
                        $.each(datal[0].steps, function (i) {
                            console.log(datal);
                            $('#listRecipeStep').append(`
        <li class="list-group-item ">
            <div class="row">
                <div class="col-lg-1 col-1 pr-lg-0 pr-2">${datal[0].steps[i].number}.</div>
                <div class="col-lg-11 col-11 pl-lg-0 pr-2">
                    ${datal[0].steps[i].step}
                </div>
            </div>
        </li>
        `);
                        });
                    }
                );

            });
        }
    </script>
</body>

</html>